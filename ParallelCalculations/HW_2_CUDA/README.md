# Задание 2. Библиотека для работы с линейными объектами в CUDA

Необходимо продумать библиотеку для работы с векторными и матричными операциями.

**Количество баллов указано в относительных величинах! Балл за задание вычисляется по формуле: процент x 1.5**

1. (5%) Сложение двух массивов (функция `KernelAdd`, файл `KernelAdd.cuh`, реализация в `KernelAdd.cu`)
2. (5%) Поэлементное перемножение двух массивов (функция `KernelMul`, файл `KernelMul.cuh`, реализация в `KernelMul.cu`)
3. (10%) Сложение двух матриц одинакового размера (функция `KernelMatrixAdd`, файл `KernelMatrixAdd.cuh`, реализация в `KernelMatrixAdd.cu`) - матрицы должны быть аллоцированы через механизм двумерных матриц
4. (10%) Перемножение матрицу на вектор (функция `MatrixVectorMul`, файл `MatrixVectorMul.cuh`, реализация в `MatrixVectorMul.cu`)
5. (15%) Вычисление скалярного произведения двух векторов (функция `ScalarMul`, файл `ScalarMul.cuh`, реализация в `KernelScalarMul.cu`)
6. (15% - можно получить после решения задачи 5) Вычисление косинуса угла между двумя векторами (на основе функции скалярного произведения)
7. (20%) Вычисление произведения двух матриц (функция `MatrixMul`, файл `MatrixMul.cuh`, реализация в `MatrixMul.cu`) через shared memory.
8. (20%) Реализация функции Filter, которая оставляет только элементы массива, удовлетворяющие соотношению (для этого необходимо реализовать функцию:

```
enum OperationFilterType {
    GT,
    LT
};

__global__ void Filter(float* array, int numElements, OperationFilterType type, float* value)
```
Количество элементов в линейных массивах не превосходят `2^28`, в задачах 5-8 - количество элементов в массивах не превосходит `2^20`.

Сборка проекта должна осуществляться через CMake.

Реализацию скалярного произведения необходимо произвести двумя способами:
* реализовать сумму внутри блока (ядро), довести вычисление одним ядром до размера блока, а после этого вычислить с помощью реализованного блока (ScalarMulSumPlusReduction) 
* реализовать ядро, которое позволит выполнить операцию сложения внутри ядра, вызвав сумму внутри блока два раза (ScalarMulTwoReductions). При этом в CommonKernels.cuh можно добавлять свои ядра (вполне возможно, что внешнее ядро и внутренние ядра могут быть различными)

Для каждой операции необходимо будет построить графики зависимости времени вычисления от размера вектора и размера блока. Время работы ядра замеряем посредством библиотеки CUDA (через CUDA Events)


## Где взять шаблон?

Шаблон задания доступен по ссылке: [клик](templates/task2_cuda)
